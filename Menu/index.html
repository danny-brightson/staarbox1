<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Select Product â€“ Staarbox</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<link rel="stylesheet" href="../Css/bootstrap.min.css">
<link rel="stylesheet" href="../Css/index.css">

<style>
/* ===== Selection behavior ===== */
.category-card {
  cursor: pointer;
  transition: 0.3s ease;
}

.category-card.selected {
  outline: 3px solid #02614e;
  transform: translateY(-6px);
  box-shadow: 0 18px 35px rgba(0,0,0,0.18);
}

/* Remove arrow completely */
.category-card .arrow {
  display: none !important;
}

/* Continue Button */
.continue-btn {
  display: block;
  margin: 50px auto 20px;
  padding: 16px 50px;
  font-size: 18px;
  font-weight: 600;
  background: #02614e;
  color: #fff;
  border: none;
  border-radius: 14px;
  opacity: 0.5;
  cursor: not-allowed;
  transition: 0.3s;
}

.continue-btn.active {
  opacity: 1;
  cursor: pointer;
}

/* Disabled non-veg items */
.disabled-nonveg {
  opacity: 0.4;
  filter: grayscale(100%);
  pointer-events: auto;
  cursor: not-allowed;
  position: relative;
}

.disabled-nonveg::after {
  content: "Box contains Non-Veg items";
  position: absolute;
  inset: 0;
  display: flex;
  align-items: center;
  justify-content: center;
  background: rgba(255,255,255,0.85);
  color: #c0392b;
  font-weight: 700;
  font-size: 14px;
  border-radius: 12px;
}

</style>
</head>

<body>

<div class="container">
  <h1 class="text-center fw-bold mt-5">Select Your Product</h1>

  <!-- ðŸ” SAME PRODUCT GRID AS YOUR WEBSITE -->
  <section class="category-section">
    <div class="category-grid">

      <div class="category-card" data-plan-id="basicfruitbowl">
        <img src="../Menu/Basic fruit bowl.png">
        <h3>Elite Bowl</h3>
        <span class="price">â‚¹1699</span>
      </div>

      <div class="category-card" data-plan-id="basicfruitbowl">
        <img src="../Menu/Basic fruit bowl.png">
        <h3>Essential Bowl</h3>
        <span class="price">â‚¹1199</span>
      </div>

      <div class="category-card" data-plan-id="kidbox" data-nonveg="true">
        <img src="../Menu/kid box.png">
        <h3>Kid Box</h3>
        <span class="price">â‚¹2299</span>
      </div>

      <div class="category-card" data-plan-id="kidvegbox">
        <img src="../Menu/kid veg box.png">
        <h3>Kid Veg Box</h3>
        <span class="price">â‚¹2299</span>
      </div>

      <div class="category-card" data-plan-id="premiumvegsandwichbox">
        <img src="../Menu/preium veg sandwich.png">
        <h3>Premium Veg Sandwich Box</h3>
        <span class="price">â‚¹4589</span>
      </div>

      <div class="category-card" data-nonveg="true" data-plan-id="premiumbox">
        <img src="../Menu/premium box.png">
        <h3>Premium Box</h3>
        <span class="price">â‚¹3499</span>
      </div>

      <div class="category-card" data-nonveg="true" data-plan-id="premiumnonvegsandwichbox">
        <img src="../Menu/Premium nonveg sandwich.png">
        <h3>Premium Non-Veg Sandwich Box</h3>
        <span class="price">â‚¹4849</span>
      </div>

      <div class="category-card" data-plan-id="premiumvegbox">
        <img src="../Menu/premium veg box.png">
        <h3>Premium Veg Box</h3>
        <span class="price">â‚¹3499</span>
      </div>

      <div class="category-card" data-nonveg="true" data-plan-id="standardbox">
        <img src="../Menu/standard box.png">
        <h3>Standard Box</h3>
        <span class="price">â‚¹2829</span>
      </div>

      <div class="category-card" data-plan-id="standardvegbox">
        <img src="../Menu/standard veg box.png">
        <h3>Standard Veg Box</h3>
        <span class="price">â‚¹2829</span>
      </div>

      <div class="category-card" data-nonveg="true" data-plan-id="standardnonvegsandwichbox">
        <img src="../Menu/Standard nonveg sandwich.png">
        <h3>Standard Non-Veg Sandwich Box</h3>
        <span class="price">â‚¹4069</span>
      </div>

      <div class="category-card" data-plan-id="standardvegsandwichbox">
        <img src="../Menu/Standard veg sandwich.png">
        <h3>Standard Veg Sandwich Box</h3>
        <span class="price">â‚¹3739</span>
      </div>

    </div>
  </section>

  <!-- Continue Button -->
  <button id="continueBtn" class="continue-btn">
    Continue to Payment
  </button>
</div>
<!-- =====  ===== -->
 <script>
   window.PLANS = [
      { id: 'kidbox', planId: 1, name: 'Kids', price: 2299, features: ['[250g-300g]'] },
      { id: 'standardbox', planId: 2, name: 'Standard', price: 2829, features: ['[300g-350]'] },
      { id: 'premiumbox', planId: 3, name: 'Premium', price: 3499, features: ['[400g-450g]'] },
      { id: 'premiumvegbox', planId: 3, name: 'Premiumvegbox', price: 3499, features: ['[400g-450g]'] },
      { id: 'standardvegbox', planId: 2, name: 'Standardvegbox', price: 2829, features: ['[300g-350]'] },
      { id: 'kidvegbox', planId: 1, name: 'Kidvegbox', price: 2299, features: ['[250g-300g]'] },
      { id: 'basicfruitbowl', planId: 4, name: 'Basicfruitbowl', price: 1699, features: ['[230g-260g]'] },
      //{ id: 'standardfruitbowl', planId: 5, name: 'Standardfruitbowl', price: 1199, features: ['[200g-240g]'] },
      { id: 'premiumnonvegsandwichbox', planId: 6, name: 'Premiumnonvegsandwichbox', price: 4849, features: ['[600g-650g]'] },
      { id: 'standardnonvegsandwichbox', planId: 7, name: 'Standardnonvegsandwichbox', price: 4069, features: ['[500g-550g]'] },
    //  { id: 'kidnonvegsandwichbox', planId: 8, name: 'Kidnonvegsandwichbox', price: 3549, features: ['[400g-450]'] },
      { id: 'premiumvegsandwichbox', planId: 9, name: 'Premiumvegsandwichbox', price: 4589, features: ['[600g-650g]'] },
      { id: 'standardvegsandwichbox', planId: 10, name: 'Standardvegsandwichbox', price: 3739, features: ['[500g-550g]'] },
     // { id: 'kidvegsandwichbox', planId: 11, name: 'Kidvegsandwichbox', price: 2899, features: ['[400g-450]'] }
     ];
  // (function(){
  //   // ------------ CONFIG ----------
  //   const API_BASE = "https://api.staarbox.in"; // change if needed
   

  //   // ---------- elements ----------
  //   const plansEl = document.getElementById('plans');
  //   const planNameEl = document.getElementById('planName');
  //   const basePriceEl = document.getElementById('basePrice');
  //   const cgstEl = document.getElementById('cgst');
  //   const sgstEl = document.getElementById('sgst');
  //   const totalPriceEl = document.getElementById('totalPrice');
  //   const promoCheck = document.getElementById('promoCheck');
  //   const promoSection = document.getElementById('promoSection');
  //   const promoCodeInput = document.getElementById('promoCode');
  //   const applyPromoBtn = document.getElementById('applyPromo');
  //   const discountRow = document.getElementById('discountRow');
  //   const discountAmtEl = document.getElementById('discountAmt');
  //   const payBtn = document.getElementById('razorpayBtn');

  //   let selected = null;
  //   let appliedPromo = null;

  //   function formatINR(n){ return 'â‚¹' + Number(n).toFixed(2); }

  //   // ---------- render plans ----------
  //   function renderPlans(){
  //     plansEl.innerHTML = '';
  //     PLANS.forEach(p => {
  //       const el = document.createElement('div');
  //       el.className = 'plan';
  //       el.tabIndex = 0;
  //       el.setAttribute('data-id', p.id);
  //       el.innerHTML = `<h3>${p.name}</h3><div class="price">${formatINR(p.price)}</div><div class="features">${p.features.join(' â€¢ ')}</div>`;
  //       el.addEventListener('click', () => selectPlan(p, el));
  //       el.addEventListener('keypress', e => { if(e.key === 'Enter') selectPlan(p, el); });
  //       plansEl.appendChild(el);
  //     });
  //   }

  //   function selectPlan(plan, el){
  //     selected = Object.assign({}, plan);
  //     appliedPromo = null;
  //     promoCodeInput.value = '';
  //     discountRow.style.display = 'none';
  //     discountAmtEl.textContent = '-â‚¹0.00';
  //     document.querySelectorAll('.plan').forEach(node => node.classList.toggle('selected', node === el));
  //     planNameEl.textContent = plan.name;
  //     basePriceEl.textContent = formatINR(plan.price);
  //     computeAndShow();
  //     payBtn.disabled = false;
  //     el.scrollIntoView({ behavior:'smooth', block:'nearest', inline:'center' });
  //   }
  // })();
</script>
<!-- ===== JS LOGIC ===== -->
<!-- <script>
let selectedPlan = null;
const continueBtn = document.getElementById("continueBtn");
const API_BASE = "https://api.staarbox.in";

document.querySelectorAll(".category-card").forEach(card => {
  card.addEventListener("click", () => {

    document.querySelectorAll(".category-card")
      .forEach(c => c.classList.remove("selected"));

    card.classList.add("selected");

    const planKey = card.dataset.planId;
    selectedPlan = PLANS.find(p => p.id === planKey);

    continueBtn.classList.add("active");
    continueBtn.disabled = false;
  });
});

continueBtn.addEventListener("click", async () => {
  if (!selectedPlan) return;

  const customerId = localStorage.getItem("customerId");
  const accessToken = localStorage.getItem("accessToken");

  if (!customerId || !accessToken) {
    alert("Session expired. Please login again.");
    return;
  }

  try {
    const payload = [{
      packDetailsId: selectedPlan.planId,
      customerId: Number(customerId)
    }];

    const res = await fetch(`${API_BASE}/api/savePackDetails`, {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "Authorization": `Bearer ${accessToken}`
      },
      body: JSON.stringify(payload)
    });

    if (!res.ok) {
      const err = await res.text();
      throw new Error(err || "Failed to save pack");
    }

    // âœ… Store FULL PLAN for payment page
    localStorage.setItem(
      "staarbox_selected_plan",
      JSON.stringify(selectedPlan)
    );

    window.location.href = "../Payment/";

  } catch (err) {
    console.error(err);
    alert("Unable to proceed. Please try again.");
  }
});
</script> -->
<script>
let selectedPlan = null;
const continueBtn = document.getElementById("continueBtn");
continueBtn.disabled = true;

document.querySelectorAll(".category-card").forEach(card => {
  card.addEventListener("click", () => {

    if (card.classList.contains("disabled-nonveg")) return;

    document.querySelectorAll(".category-card")
      .forEach(c => c.classList.remove("selected"));

    card.classList.add("selected");

    const planKey = card.dataset.planId;
    selectedPlan = window.PLANS.find(p => p.id === planKey);

    if (!selectedPlan) {
      console.error("Plan not found:", planKey);
      continueBtn.disabled = true;
      return;
    }

    continueBtn.classList.add("active");
    continueBtn.disabled = false;
  });
});

continueBtn.addEventListener("click", async () => {
  if (!selectedPlan) return;

  const customerId = localStorage.getItem("CustomerId");
  const token = localStorage.getItem("accessToken");

  if (!customerId || !token) {
    alert("Session expired. Please login again.");
    window.location.href = "../login/";
    return;
  }

  try {
    const payload = [{
      packDetailsId: selectedPlan.planId,
      customerId: Number(customerId)
    }];

    const res = await fetch("https://api.staarbox.in/api/savePackDetails", {
      method: "POST",
      headers: {
        "Content-Type": "application/json",
        "Authorization": `Bearer ${token}`
      },
      body: JSON.stringify(payload)
    });

    if (!res.ok) throw new Error(await res.text());

    localStorage.setItem(
      "staarbox_selected_plan",
      JSON.stringify(selectedPlan)
    );

    window.location.href = "../Payment/";

  } catch (err) {
    console.error(err);
    alert("Unable to proceed. Please try again.");
  }
});
</script>


<script>
(function () {
  // default â†’ egg NOT allowed
  const isEggAllowed =
    localStorage.getItem("staarbox_isEggAllowed") === "true";

  if (!isEggAllowed) {
    document.querySelectorAll('[data-nonveg="true"]').forEach(card => {
      card.classList.add('disabled-nonveg');

      card.addEventListener('click', function (e) {
        e.preventDefault();
        e.stopPropagation();
        alert("Non-Veg items are disabled because Egg preference is set to No.");
      });
    });
  }
})();
</script>


</body>
</html>
